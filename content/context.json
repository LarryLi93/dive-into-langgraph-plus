{"version":3,"kind":"Notebook","sha256":"098296d8041917b9cc7271d6c8b2a6e539c831164512d177735b45435b167c68","slug":"context","location":"/6.context.ipynb","dependencies":[],"frontmatter":{"title":"ä¸Šä¸‹æ–‡å·¥ç¨‹","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Larry Li","given":"Larry","family":"Li"},"name":"Larry Li","id":"contributors-Users\\Lenovo\\Desktop\\product\\dive-into-langgraph-plus\\myst-generated-uid-0"}],"github":"https://github.com/LarryLi93/dive-into-langgraph-plus","exports":[{"format":"ipynb","filename":"6.context.ipynb","url":"/6.context-deda729c2b45e1fbe562deff5c65021f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://docs.langchain.com/oss/python/langchain/context-engineering","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ä¸Šä¸‹æ–‡å·¥ç¨‹","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eKhEsYy2Uk"}],"urlSource":"https://docs.langchain.com/oss/python/langchain/context-engineering","key":"kTORzNSQkr"},{"type":"text","value":"ï¼ˆContext Engineeringï¼‰å¯¹äº Agent å¾—å‡ºæ­£ç¡®çš„ç»“æœè‡³å…³é‡è¦ã€‚æ¨¡å‹å›ç­”ä¸å¥½ï¼Œå¾ˆå¤šæ—¶å€™ä¸æ˜¯å› ä¸ºèƒ½åŠ›ä¸è¶³ï¼Œè€Œæ˜¯å› ä¸ºæ²¡æœ‰è·å¾—è¶³ä»¥æ¨æ–­å‡ºæ­£ç¡®ç»“æœçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚é€šè¿‡ä¸Šä¸‹æ–‡å·¥ç¨‹ï¼Œå¢å¼º Agent è·å–å’Œç®¡ç†ä¸Šä¸‹æ–‡çš„èƒ½åŠ›ï¼Œæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gk8rKk7Bbb"}],"key":"GkWnPsqugR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"LangGraph å°†ä¸Šä¸‹æ–‡åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dml2krFPrI"}],"key":"Jm8KLVnaAH"}],"key":"Ft9PhcZ9p7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"æ¨¡å‹ä¸Šä¸‹æ–‡ï¼ˆModel Contextï¼‰","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cj7CzQ4jY6"}],"key":"TqkwTMTgVj"}],"key":"KsrJhjthlA"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"å·¥å…·ä¸Šä¸‹æ–‡ï¼ˆTool Contextï¼‰","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"SsRBn0KcZv"}],"key":"hQs8gusVna"}],"key":"iA5Dv86wpK"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ç”Ÿå‘½å‘¨æœŸä¸Šä¸‹æ–‡ï¼ˆLife-cycle Contextï¼‰","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dmfz68tUue"}],"key":"vuyX1u3g7j"}],"key":"Cm5VVOtQVa"}],"key":"tkoK2TzlDZ"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"æ— è®ºå“ªç§ Contextï¼Œéƒ½éœ€è¦å®šä¹‰å®ƒçš„ Schemaã€‚åœ¨è¿™æ–¹é¢ï¼ŒLangGraph æä¾›äº†ç›¸å½“é«˜çš„è‡ªç”±åº¦ï¼Œä½ å¯ä»¥ä½¿ç”¨ ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"xHaR5T6bpj"},{"type":"inlineCode","value":"dataclasses","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"P8eyK9piew"},{"type":"text","value":"ã€","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oG7vEtZ8gx"},{"type":"inlineCode","value":"pydantic","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QWmeoLBezp"},{"type":"text","value":"ã€","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tnwt08ayQS"},{"type":"inlineCode","value":"TypedDict","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UBohSlo2OY"},{"type":"text","value":" è¿™äº›åŒ…çš„ä»»æ„ä¸€ä¸ªåˆ›å»ºä½ çš„ Context Schema.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"WwFk8lIQ8G"}],"key":"dbc51IFDoS"}],"key":"AN0ZkF7dfN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# !pip install ipynbname","key":"auPhkRedNu"},{"type":"outputs","id":"BmxV-yL0Ra1JwECOhCATf","children":[],"key":"RtQrGYNhM4"}],"key":"HAi3r3VHil"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport uuid\nimport sqlite3\n\nfrom typing import Callable\nfrom dotenv import load_dotenv\nfrom dataclasses import dataclass\nfrom langchain_openai import ChatOpenAI\nfrom langchain.tools import tool, ToolRuntime\nfrom langchain.agents import create_agent\nfrom langchain.agents.middleware import dynamic_prompt, wrap_model_call, ModelRequest, ModelResponse, SummarizationMiddleware\nfrom langgraph.graph import StateGraph, MessagesState, START, END\nfrom langgraph.checkpoint.memory import InMemorySaver\nfrom langgraph.store.memory import InMemoryStore\nfrom langgraph.store.sqlite import SqliteStore\n\n# åŠ è½½æ¨¡å‹é…ç½®\n_ = load_dotenv()\n\n# åŠ è½½æ¨¡å‹\nllm = ChatOpenAI(\n    api_key=os.getenv(\"DASHSCOPE_API_KEY\"),\n    base_url=os.getenv(\"DASHSCOPE_BASE_URL\"),\n    model=\"qwen3-coder-plus\",\n    temperature=0.7,\n)","key":"ovor6ipR3B"},{"type":"outputs","id":"cxyxIO5b1IyMKf0iq4h6S","children":[],"key":"YKWKfCnjaa"}],"key":"hSPeF6AjTL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ä¸€ã€åŠ¨æ€ä¿®æ”¹ç³»ç»Ÿæç¤ºè¯","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VuKDPCdjE3"}],"identifier":"id","label":"ä¸€ã€åŠ¨æ€ä¿®æ”¹ç³»ç»Ÿæç¤ºè¯","html_id":"id","implicit":true,"key":"g4oalP2s0i"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ä¸Šä¸‹æ–‡å·¥ç¨‹ä¸å‰åºç« èŠ‚çš„ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰å’Œè®°å¿†ï¼ˆmemoryï¼‰å¯†ä¸å¯åˆ†ã€‚ä¸Šä¸‹æ–‡çš„å…·ä½“å®ç°ä¾èµ–ä¸­é—´ä»¶ï¼Œè€Œä¸Šä¸‹æ–‡çš„å­˜å‚¨åˆ™ä¾èµ–è®°å¿†ç³»ç»Ÿã€‚å…·ä½“æ¥è®²ï¼ŒLangGraph é¢„ç½®äº† ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SiE4eGxCWc"},{"type":"inlineCode","value":"@dynamic_prompt","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aqYoqPjbNk"},{"type":"text","value":" ä¸­é—´ä»¶ï¼Œç”¨äºåŠ¨æ€ä¿®æ”¹ç³»ç»Ÿæç¤ºè¯ã€‚","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yyBxrhyMsp"}],"key":"pXr9WUgtqU"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"æ—¢ç„¶æ˜¯åŠ¨æ€ä¿®æ”¹ï¼Œè‚¯å®šéœ€è¦æŸä¸ªæ¡ä»¶æ¥è§¦å‘ä¿®æ”¹ã€‚é™¤äº†å¼€å‘è§¦å‘é€»è¾‘ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä»æ™ºèƒ½ä½“ä¸­è·å–è§¦å‘é€»è¾‘æ‰€éœ€çš„å³æ—¶å˜é‡ã€‚è¿™äº›å˜é‡é€šå¸¸å­˜å‚¨åœ¨ä»¥ä¸‹ä¸‰ä¸ªå­˜å‚¨ä»‹è´¨ä¸­ï¼š","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mFidgUTqCy"}],"key":"eMdpHjOla2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰- æ‰€æœ‰èŠ‚ç‚¹å…±äº«ä¸€ä¸ª Runtimeã€‚åŒä¸€æ—¶åˆ»ï¼Œæ‰€æœ‰èŠ‚ç‚¹å–åˆ°çš„ Runtime çš„å€¼æ˜¯ç›¸åŒçš„ã€‚ä¸€èˆ¬ç”¨äºå­˜å‚¨æ—¶æ•ˆæ€§è¦æ±‚è¾ƒé«˜çš„ä¿¡æ¯ã€‚","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jOQRdVG7Xj"}],"key":"HEUha1YcyS"}],"key":"ZU7kYso9rp"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"çŸ­æœŸè®°å¿†ï¼ˆStateï¼‰- åœ¨èŠ‚ç‚¹ä¹‹é—´æŒ‰é¡ºåºä¼ é€’ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ¥æ”¶ä¸Šä¸€ä¸ªèŠ‚ç‚¹å¤„ç†åçš„ Stateã€‚ä¸»è¦ç”¨äºå­˜å‚¨ Prompt å’Œ AI Messageã€‚","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"x4I7ZZuthc"}],"key":"iEfuWS1u9d"}],"key":"Nn7h3W2a1f"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"é•¿æœŸè®°å¿†ï¼ˆStoreï¼‰- è´Ÿè´£æŒä¹…åŒ–å­˜å‚¨ï¼Œå¯ä»¥è·¨ Workflow / Agent ä¿å­˜ä¿¡æ¯ã€‚å¯ä»¥ç”¨æ¥å­˜ç”¨æˆ·åå¥½ã€ä»¥å‰ç®—è¿‡çš„ç»Ÿè®¡å€¼ç­‰ã€‚","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"F3JRUul72m"}],"key":"A1Ozxapek3"}],"key":"Asvx2gMU2C"}],"key":"ZtppUkFVvP"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"ä»¥ä¸‹ä¸‰ä¸ªä¾‹å­ï¼Œåˆ†åˆ«æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨æ¥è‡ª Runtimeã€Stateã€Store ä¸­çš„ä¸Šä¸‹æ–‡ï¼Œç¼–å†™è§¦å‘æ¡ä»¶ã€‚","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nUotWAEcqa"}],"key":"MVJeNbEHmm"},{"type":"heading","depth":3,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"1ï¼‰ä½¿ç”¨ ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uG3vQigCuF"},{"type":"inlineCode","value":"State","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uBO9JrpsAx"},{"type":"text","value":" ç®¡ç†ä¸Šä¸‹æ–‡","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"pam1XziCrK"}],"identifier":"id-1-state","label":"1ï¼‰ä½¿ç”¨ State ç®¡ç†ä¸Šä¸‹æ–‡","html_id":"id-1-state","implicit":true,"key":"WfczCwRcWg"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"åˆ©ç”¨ ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TB4TcC9xff"},{"type":"inlineCode","value":"State","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"XA2IiIDid2"},{"type":"text","value":" ä¸­è•´å«çš„ä¿¡æ¯æ“çºµ system prompt.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"WeWEWyR2I6"}],"key":"XPShUsWQzb"}],"key":"CsKpPu1xZq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@dynamic_prompt\ndef state_aware_prompt(request: ModelRequest) -> str:\n    # request.messages is a shortcut for request.state[\"messages\"]\n    message_count = len(request.messages)\n\n    base = \"You are a helpful assistant.\"\n\n    if message_count > 6:\n        base += \"\\nThis is a long conversation - be extra concise.\"\n\n    # ä¸´æ—¶æ‰“å°baseçœ‹æ•ˆæœ\n    print(base)\n\n    return base\n\nagent = create_agent(\n    model=llm,\n    middleware=[state_aware_prompt]\n)\n\nresult = agent.invoke(\n    {\"messages\": [\n        {\"role\": \"user\", \"content\": \"å¹¿å·ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ\"},\n        {\"role\": \"assistant\", \"content\": \"å¹¿å·å¤©æ°”å¾ˆå¥½\"},\n        {\"role\": \"user\", \"content\": \"åƒç‚¹ä»€ä¹ˆå¥½å‘¢\"},\n        {\"role\": \"assistant\", \"content\": \"è¦ä¸è¦åƒé¦™èŒ…é³—é±¼ç…²\"},\n        {\"role\": \"user\", \"content\": \"é¦™èŒ…æ˜¯ä»€ä¹ˆ\"},\n        {\"role\": \"assistant\", \"content\": \"é¦™èŒ…åˆåæŸ æª¬è‰ï¼Œå¸¸è§äºæ³°å¼å†¬é˜´åŠŸæ±¤ã€è¶Šå—çƒ¤è‚‰\"},\n        {\"role\": \"user\", \"content\": \"auv é‚£è¿˜ç­‰ä»€ä¹ˆï¼Œå’±åƒå»å§\"},\n    ]},\n)\n\nfor message in result['messages']:\n    message.pretty_print()","key":"bEEUohP7td"},{"type":"outputs","id":"3xXLdUMsaat5jHzyVEHij","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"You are a helpful assistant.\nThis is a long conversation - be extra concise.\n================================\u001b[1m Human Message \u001b[0m=================================\n\nå¹¿å·ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\nå¹¿å·å¤©æ°”å¾ˆå¥½\n================================\u001b[1m Human Message \u001b[0m=================================\n\nåƒç‚¹ä»€ä¹ˆå¥½å‘¢\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\nè¦ä¸è¦åƒé¦™èŒ…é³—é±¼ç…²\n================================\u001b[1m Human Message \u001b[0m=================================\n\né¦™èŒ…æ˜¯ä»€ä¹ˆ\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\né¦™èŒ…åˆåæŸ æª¬è‰ï¼Œå¸¸è§äºæ³°å¼å†¬é˜´åŠŸæ±¤ã€è¶Šå—çƒ¤è‚‰\n================================\u001b[1m Human Message \u001b[0m=================================\n\nauv é‚£è¿˜ç­‰ä»€ä¹ˆï¼Œå’±åƒå»å§\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\nå¥½ä¸»æ„ï¼é¦™èŒ…é³—é±¼ç…²å¬èµ·æ¥å¾ˆç¾å‘³ï¼Œèµ°å§ï¼\n"},"children":[],"key":"B0ZvaWbU3S"}],"key":"aMDYjEHC70"}],"key":"SUmAYrC22d"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"æŠŠ ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xBjOnGHAul"},{"type":"inlineCode","value":"message_count > 6","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H8q93Ilzn9"},{"type":"text","value":" é‡Œçš„ 6 æ”¹æˆ 7ï¼Œè¯•è¯•çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LC5iPfjiAP"}],"key":"VGyYG6Rv4R"}],"key":"bcOonwm06N"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2ï¼‰ä½¿ç”¨ ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XY5q2igCGi"},{"type":"inlineCode","value":"Store","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bukwlmQArv"},{"type":"text","value":" ç®¡ç†ä¸Šä¸‹æ–‡","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R5pxUfTaic"}],"identifier":"id-2-store","label":"2ï¼‰ä½¿ç”¨ Store ç®¡ç†ä¸Šä¸‹æ–‡","html_id":"id-2-store","implicit":true,"key":"elWim9fJ1R"}],"key":"BJMG7MLcmv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@dataclass\nclass Context:\n    user_id: str\n\n@dynamic_prompt\ndef store_aware_prompt(request: ModelRequest) -> str:\n    user_id = request.runtime.context.user_id\n\n    # Read from Store: get user preferences\n    store = request.runtime.store\n    user_prefs = store.get((\"preferences\",), user_id)\n\n    base = \"You are a helpful assistant.\"\n\n    if user_prefs:\n        style = user_prefs.value.get(\"communication_style\", \"balanced\")\n        base += f\"\\nUser prefers {style} responses.\"\n\n    return base\n\nstore = InMemoryStore()\n\nagent = create_agent(\n    model=llm,\n    middleware=[store_aware_prompt],\n    context_schema=Context,\n    store=store,\n)\n\n# é¢„ç½®ä¸¤æ¡åå¥½ä¿¡æ¯\nstore.put((\"preferences\",), \"user_1\", {\"communication_style\": \"Chinese\"})\nstore.put((\"preferences\",), \"user_2\", {\"communication_style\": \"Korean\"})","key":"DfVGtJal3q"},{"type":"outputs","id":"tXgjyTGk51VbaovPUlOAz","children":[],"key":"OzUqWcLDSF"}],"key":"RoujpLL31Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ç”¨æˆ·1å–œæ¬¢ä¸­æ–‡å›å¤\nresult = agent.invoke(\n    {\"messages\": [\n        {\"role\": \"system\", \"content\": \"You are a helpful assistant. Please be extra concise.\"},\n        {\"role\": \"user\", \"content\": 'What is a \"hold short line\"?'}\n    ]},\n    context=Context(user_id=\"user_1\"),\n)\n\nfor message in result['messages']:\n    message.pretty_print()","key":"rLn2j5xknY"},{"type":"outputs","id":"LR77ahcS5CqKTUDEtkzmm","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"================================\u001b[1m System Message \u001b[0m================================\n\nYou are a helpful assistant. Please be extra concise.\n================================\u001b[1m Human Message \u001b[0m=================================\n\nWhat is a \"hold short line\"?\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\n\"Hold short line\" æ˜¯èˆªç©ºæœ¯è¯­ï¼ŒæŒ‡è·‘é“æˆ–æ»‘è¡Œé“ä¸Šçš„ä¸€æ¡æ ‡è®°çº¿ï¼Œè¦æ±‚é£æœºåœ¨æ­¤çº¿å‰åœæ­¢ï¼Œä¸å¾—è¶Šè¿‡ã€‚é€šå¸¸ç”¨äºï¼š\n\n1. **è·‘é“ç­‰å¾…çº¿** - ç­‰å¾…èµ·é£è®¸å¯\n2. **æ»‘è¡Œé“ç­‰å¾…çº¿** - ç­‰å¾…è¿›å…¥è·‘é“æˆ–å…¶ä»–åŒºåŸŸ\n\nè¿™æ˜¯é£è¡Œå®‰å…¨çš„é‡è¦ç¨‹åºã€‚\n"},"children":[],"key":"lPbHxsbCVE"}],"key":"Vql8Qy6v7Z"}],"key":"C7W05TATF2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ç”¨æˆ·2å–œæ¬¢éŸ©æ–‡å›å¤\nresult = agent.invoke(\n    {\"messages\": [\n        {\"role\": \"system\", \"content\": \"You are a helpful assistant. Please be extra concise.\"},\n        {\"role\": \"user\", \"content\": 'What is a \"hold short line\"?'}\n    ]},\n    context=Context(user_id=\"user_2\"),\n)\n\nfor message in result['messages']:\n    message.pretty_print()","key":"syQZJUMS4c"},{"type":"outputs","id":"mlZuEKzvW8oskABFbx1yY","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"================================\u001b[1m System Message \u001b[0m================================\n\nYou are a helpful assistant. Please be extra concise.\n================================\u001b[1m Human Message \u001b[0m=================================\n\nWhat is a \"hold short line\"?\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\n\"í™€ë“œ ì‡¼íŠ¸ ë¼ì¸(Hold Short Line)\"ì€ ê³µí•­ í™œì£¼ë¡œì—ì„œ í•­ê³µê¸°ê°€ íŠ¹ì • ì§€ì ê¹Œì§€ë§Œ ì§„ì…í•˜ë„ë¡ ì§€ì‹œí•˜ëŠ” ì„ ì…ë‹ˆë‹¤. ì´ ì„ ì„ ë„˜ì–´ì„œëŠ” ê²ƒì€ ê¸ˆì§€ë˜ì–´ ìˆìœ¼ë©°, ê´€ì œì†Œì˜ í—ˆê°€ë¥¼ ë°›ì•„ì•¼ë§Œ ì§„ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì£¼ë¡œ í™œì£¼ë¡œì™€ êµì°¨í•˜ëŠ” ì§€ì ì´ë‚˜ í™œì£¼ë¡œ ì§„ì… ì „ì— ì„¤ì¹˜ë˜ì–´ ì•ˆì „ì„ í™•ë³´í•©ë‹ˆë‹¤.\n"},"children":[],"key":"zRLA3BNKly"}],"key":"XzQlBWhmvI"}],"key":"lvL1M3hNio"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3ï¼‰ä½¿ç”¨ ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EvaD9m6nRj"},{"type":"inlineCode","value":"Runtime","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k0boZi624t"},{"type":"text","value":" ç®¡ç†ä¸Šä¸‹æ–‡","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L1Wl02ivZv"}],"identifier":"id-3-runtime","label":"3ï¼‰ä½¿ç”¨ Runtime ç®¡ç†ä¸Šä¸‹æ–‡","html_id":"id-3-runtime","implicit":true,"key":"Grc55cwD5W"}],"key":"GxsTnZdHxT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@dataclass\nclass Context:\n    user_role: str\n    deployment_env: str\n\n@dynamic_prompt\ndef context_aware_prompt(request: ModelRequest) -> str:\n    # Read from Runtime Context: user role and environment\n    user_role = request.runtime.context.user_role\n    env = request.runtime.context.deployment_env\n\n    base = \"You are a helpful assistant.\"\n\n    if user_role == \"admin\":\n        base += \"\\nYou can use the get_weather tool.\"\n    else:\n        base += \"\\nYou are prohibited from using the get_weather tool.\"\n\n    if env == \"production\":\n        base += \"\\nBe extra careful with any data modifications.\"\n\n    return base\n\n@tool\ndef get_weather(city: str) -> str:\n    \"\"\"Get weather for a given city.\"\"\"\n    return f\"It's always sunny in {city}!\"\n\nagent = create_agent(\n    model=llm,\n    tools=[get_weather],\n    middleware=[context_aware_prompt],\n    context_schema=Context,\n    checkpointer=InMemorySaver(),\n)","key":"ImFGjiW4on"},{"type":"outputs","id":"xeOb1-ACdM8HxMZ9JD96c","children":[],"key":"mlrwkDlLwk"}],"key":"RA6EC0oS52"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# åˆ©ç”¨ Runtime ä¸­çš„ä¸¤ä¸ªå˜é‡ï¼ŒåŠ¨æ€æ§åˆ¶ System prompt\n# å°† user_role è®¾ä¸º adminï¼Œå…è®¸ä½¿ç”¨å¤©æ°”æŸ¥è¯¢å·¥å…·\nconfig = {'configurable': {'thread_id': str(uuid.uuid4())}}\nresult = agent.invoke(\n    {\"messages\": [{\"role\": \"user\", \"content\": \"å¹¿å·ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ\"}]},\n    context=Context(user_role=\"admin\", deployment_env=\"production\"),\n    config=config,\n)\n\nfor message in result['messages']:\n    message.pretty_print()","key":"ngRgwfIuc8"},{"type":"outputs","id":"V6R4joryDxRXUw1qv00_U","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"================================\u001b[1m Human Message \u001b[0m=================================\n\nå¹¿å·ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ\n==================================\u001b[1m Ai Message \u001b[0m==================================\nTool Calls:\n  get_weather (call_b7a1beefd02f4703a3d0caaa)\n Call ID: call_b7a1beefd02f4703a3d0caaa\n  Args:\n    city: å¹¿å·\n=================================\u001b[1m Tool Message \u001b[0m=================================\nName: get_weather\n\nIt's always sunny in å¹¿å·!\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\næ ¹æ®æˆ‘è·å–çš„ä¿¡æ¯ï¼Œå¹¿å·ä»Šå¤©æ˜¯æ™´å¤©ï¼æ°”æ¸©é€‚å®œï¼Œé˜³å…‰æ˜åªšã€‚å¦‚æœä½ åœ¨å¹¿å·ï¼Œè®°å¾—åšå¥½é˜²æ™’æªæ–½ï¼Œäº«å—ç¾å¥½çš„ä¸€å¤©ï¼\n"},"children":[],"key":"P6vXbe536i"}],"key":"K1CeWqWPtj"}],"key":"aqMKzGCoF6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# è‹¥å°† user_role æ”¹ä¸º viewerï¼Œåˆ™æ— æ³•ä½¿ç”¨å¤©æ°”æŸ¥è¯¢å·¥å…·\nconfig = {'configurable': {'thread_id': str(uuid.uuid4())}}\nresult = agent.invoke(\n    {\"messages\": [{\"role\": \"user\", \"content\": \"å¹¿å·ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ\"}]},\n    context=Context(user_role=\"viewer\", deployment_env=\"production\"),\n    config=config,\n)\n\nfor message in result['messages']:\n    message.pretty_print()","key":"Fo1EZNxHfY"},{"type":"outputs","id":"xhvcLtVs7YbVG0Fw6H4AL","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"================================\u001b[1m Human Message \u001b[0m=================================\n\nå¹¿å·ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\næŠ±æ­‰ï¼Œæˆ‘æ— æ³•è·å–å¤©æ°”ä¿¡æ¯ã€‚æ‚¨å¯ä»¥é€šè¿‡å…¶ä»–é€”å¾„æŸ¥è¯¢å¹¿å·ä»Šå¤©çš„å¤©æ°”ï¼Œä¾‹å¦‚ä½¿ç”¨å¤©æ°”åº”ç”¨æˆ–è®¿é—®å¤©æ°”ç½‘ç«™ã€‚\n"},"children":[],"key":"lMLQtLjV6f"}],"key":"tN3syzQKKw"}],"key":"XLFSXFiyGk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result['messages']","key":"FyszzRKcNC"},{"type":"outputs","id":"OfGCGaZ7iWRJkeVinmSFa","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"[HumanMessage(content='å¹¿å·ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ', additional_kwargs={}, response_metadata={}, id='58493935-80a8-4f05-818d-4fa3ef684657'),\n AIMessage(content='æŠ±æ­‰ï¼Œæˆ‘æ— æ³•è·å–å¤©æ°”ä¿¡æ¯ã€‚æ‚¨å¯ä»¥é€šè¿‡å…¶ä»–é€”å¾„æŸ¥è¯¢å¹¿å·ä»Šå¤©çš„å¤©æ°”ï¼Œä¾‹å¦‚ä½¿ç”¨å¤©æ°”åº”ç”¨æˆ–è®¿é—®å¤©æ°”ç½‘ç«™ã€‚', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 26, 'prompt_tokens': 287, 'total_tokens': 313, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'qwen3-coder-plus', 'system_fingerprint': None, 'id': 'chatcmpl-b3da39f7-8f49-4a63-9794-06bd7578354f', 'finish_reason': 'stop', 'logprobs': None}, id='lc_run--5c17667c-38c3-4856-9610-9d6f4cfd4d16-0', usage_metadata={'input_tokens': 287, 'output_tokens': 26, 'total_tokens': 313, 'input_token_details': {'cache_read': 0}, 'output_token_details': {}})]","content_type":"text/plain"}}},"children":[],"key":"IpAD4DBPFN"}],"key":"t9a5c9bdsh"}],"key":"FzUPZiQmlw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"äºŒã€åŠ¨æ€ä¿®æ”¹æ¶ˆæ¯åˆ—è¡¨","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EIA7HsW88Z"}],"identifier":"id","label":"äºŒã€åŠ¨æ€ä¿®æ”¹æ¶ˆæ¯åˆ—è¡¨","html_id":"id-1","implicit":true,"key":"v1UpAk3jDa"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"LangGraph é¢„åˆ¶äº†åŠ¨æ€ä¿®æ”¹æ¶ˆæ¯åˆ—è¡¨ï¼ˆMessagesï¼‰çš„ä¸­é—´ä»¶ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fPF6d5qQUO"},{"type":"inlineCode","value":"@wrap_model_call","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"brMRB73Txu"},{"type":"text","value":"ã€‚ä¸Šä¸€èŠ‚å·²ç»æ¼”ç¤ºå¦‚ä½•ä» ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SwNw7LZ6Fk"},{"type":"inlineCode","value":"State","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VHuVDqEvjG"},{"type":"text","value":"ã€","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"buY6Y285Uk"},{"type":"inlineCode","value":"Store","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iXRm9fNS9n"},{"type":"text","value":"ã€","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PKCHctihTM"},{"type":"inlineCode","value":"Runtime","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eK037Sewzs"},{"type":"text","value":" ä¸­è·å–ä¸Šä¸‹æ–‡ï¼Œæœ¬èŠ‚å°†ä¸å†ä¸€ä¸€æ¼”ç¤ºã€‚åœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OlgI0QRcaL"},{"type":"inlineCode","value":"Runtime","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LMIX7yx4fI"},{"type":"text","value":" å°†æœ¬åœ°æ–‡ä»¶çš„å†…å®¹æ³¨å…¥æ¶ˆæ¯åˆ—è¡¨ã€‚","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JUO4RJswvZ"}],"key":"C3Bz1OAtv8"}],"key":"hMvr1DFPIN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@dataclass\nclass FileContext:\n    uploaded_files: list[dict]\n\n@wrap_model_call\ndef inject_file_context(\n    request: ModelRequest,\n    handler: Callable[[ModelRequest], ModelResponse]\n) -> ModelResponse:\n    \"\"\"Inject context about files user has uploaded this session.\"\"\"\n    uploaded_files = request.runtime.context.uploaded_files\n\n    try:\n        base_dir = os.path.dirname(os.path.abspath(__file__))\n    except Exception as e:\n        import ipynbname\n        import os\n        notebook_path = ipynbname.path()\n        base_dir = os.path.dirname(notebook_path)\n\n    file_sections = []\n    for file in uploaded_files:\n        name, ftype = \"\", \"\"\n        path = file.get(\"path\")\n        if path:\n            base_filename = os.path.basename(path)\n            stem, ext = os.path.splitext(base_filename)\n            name = stem or base_filename\n            ftype = (ext.lstrip(\".\") if ext else None)\n\n            # æ„å»ºæ–‡ä»¶æè¿°å†…å®¹\n            content_list = [f\"åç§°: {name}\"]\n            if ftype:\n                content_list.append(f\"ç±»å‹: {ftype}\")\n\n            # è§£æç›¸å¯¹è·¯å¾„ä¸ºç»å¯¹è·¯å¾„\n            abs_path = path if os.path.isabs(path) else os.path.join(base_dir, path)\n\n            # è¯»å–æ–‡ä»¶å†…å®¹\n            content_block = \"\"\n            if abs_path and os.path.exists(abs_path):\n                try:\n                    with open(abs_path, \"r\", encoding=\"utf-8\") as f:\n                        content_block = f.read()\n                except Exception as e:\n                    content_block = f\"[è¯»å–æ–‡ä»¶é”™è¯¯ '{abs_path}': {e}]\"\n            else:\n                content_block = \"[æ–‡ä»¶è·¯å¾„ç¼ºå¤±æˆ–æœªæ‰¾åˆ°]\"\n\n            section = (\n                f\"---\\n\"\n                f\"{chr(10).join(content_list)}\\n\\n\"\n                f\"{content_block}\\n\"\n                f\"---\"\n            )\n            file_sections.append(section)\n\n        file_context = (\n            \"å·²åŠ è½½çš„ä¼šè¯æ–‡ä»¶ï¼š\\n\"\n            f\"{chr(10).join(file_sections)}\"\n            \"\\nå›ç­”é—®é¢˜æ—¶è¯·å‚è€ƒè¿™äº›æ–‡ä»¶ã€‚\"\n        )\n\n        # Inject file context before recent messages\n        messages = [  \n            *request.messages,\n            {\"role\": \"user\", \"content\": file_context},\n        ]\n        request = request.override(messages=messages)  \n\n    return handler(request)\n\nagent = create_agent(\n    model=llm,\n    middleware=[inject_file_context],\n    context_schema=FileContext,\n)","key":"H9T9cGee4w"},{"type":"outputs","id":"-e69cLHPzo45knbF3e5e8","children":[],"key":"Kj8azbROLX"}],"key":"pb1IjAaUxK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result = agent.invoke(\n    {\n        \"messages\": [{\n            \"role\": \"user\",\n            \"content\": \"å…³äºä¸Šæµ·åœ°é“çš„æ— è„¸ä¹˜å®¢ï¼Œæœ‰ä»€ä¹ˆéœ€è¦æ³¨æ„çš„ï¼Ÿ\",\n        }],\n    },\n    context=FileContext(uploaded_files=[{\"path\": \"./docs/rule_horror.md\"}]),\n)\n\nfor message in result['messages']:\n    message.pretty_print()","key":"vZfF7fYBlR"},{"type":"outputs","id":"S-9YjiaNNh8QQOvFo0Irl","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"================================\u001b[1m Human Message \u001b[0m=================================\n\nå…³äºä¸Šæµ·åœ°é“çš„æ— è„¸ä¹˜å®¢ï¼Œæœ‰ä»€ä¹ˆéœ€è¦æ³¨æ„çš„ï¼Ÿ\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\næ ¹æ®ã€Šä¸Šæµ·è§„åˆ™æ€ªè°ˆã€‹ä¸­çš„æè¿°ï¼Œå…³äºä¸Šæµ·åœ°é“çš„â€œæ— è„¸ä¹˜å®¢â€ï¼Œä½ éœ€è¦ç‰¹åˆ«æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š\n\n---\n\n### ğŸš‡ **åœ°é“ä¸Šçš„é™Œç”Ÿäººï¼ˆæ— è„¸ä¹˜å®¢ï¼‰è§„åˆ™ï¼š**\n\n> **â€œåœ°é“è¿è¥ç»“æŸåï¼Œè‹¥ä½ ä»èº«å¤„è½¦å¢å†…ï¼Œä¼šå‡ºç°ä¸€ä½æ— è„¸ä¹˜å®¢ã€‚ä»–ä¼šä½å£°é—®ï¼šâ€˜ä½ è¦å»å“ªï¼Ÿâ€™åªèƒ½æŠ¥ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ä¸Šæµ·åœ°åã€‚è¯´å‡ºä¸å­˜åœ¨çš„åœ°åæˆ–ä¿æŒæ²‰é»˜ï¼Œä½ ä¼šåœ¨è½¦å¢å†…çœ‹åˆ°è‡ªå·±çš„å°¸ä½“ã€‚â€**\n\n---\n\n### âš ï¸ æ³¨æ„äº‹é¡¹ï¼š\n\n1. **æ—¶é—´ç‚¹ï¼š**  \n   è¯¥ç°è±¡å‘ç”Ÿåœ¨**åœ°é“è¿è¥ç»“æŸä¹‹å**ï¼Œå¦‚æœä½ å› æŸç§åŸå› æ»ç•™åœ¨åœ°é“è½¦å¢å†…ï¼Œè¯·æé«˜è­¦æƒ•ã€‚\n\n2. **æ— è„¸ä¹˜å®¢çš„å‡ºç°ï¼š**  \n   ä»–ä¼šä¸»åŠ¨é è¿‘ä½ ï¼Œå¹¶ä½å£°è¯¢é—®ï¼šâ€œ**ä½ è¦å»å“ªï¼Ÿ**â€\n\n3. **æ­£ç¡®åº”å¯¹æ–¹å¼ï¼š**  \n   - å¿…é¡»å›ç­”ä¸€ä¸ª**çœŸå®å­˜åœ¨äºä¸Šæµ·çš„åœ°å**ï¼Œä¾‹å¦‚â€œäººæ°‘å¹¿åœºâ€ã€â€œå¾å®¶æ±‡â€ã€â€œé™†å®¶å˜´â€ç­‰ã€‚\n   - å›ç­”è¦æ¸…æ™°ã€å‡†ç¡®ï¼Œä¸èƒ½çŠ¹è±«æˆ–è¯´é”™ã€‚\n\n4. **é”™è¯¯è¡Œä¸ºåŠåæœï¼š**  \n   - è‹¥ä½ å›ç­”ä¸€ä¸ª**ä¸å­˜åœ¨çš„åœ°å**ï¼ˆå¦‚â€œæ–°å®¿â€ã€â€œç‹åºœäº•â€ï¼‰ï¼Œæˆ–**ä¿æŒæ²‰é»˜**ï¼Œä½ å°†ä¼šåœ¨è½¦å¢ä¸­çœ‹åˆ°**è‡ªå·±çš„å°¸ä½“**ã€‚\n   - è¿™æ„å‘³ç€ä½ å°†æ— æ³•é€ƒè„±æ­»äº¡çš„å‘½è¿ã€‚\n\n---\n\n### ğŸ§  å°è´´å£«ï¼š\n\n- å¦‚æœä½ ä¸ç¡®å®šæŸä¸ªåœ°åæ˜¯å¦å±äºä¸Šæµ·ï¼Œå»ºè®®æå‰äº†è§£ä¸€äº›çœŸå®åœ°åä»¥é˜²ä¸‡ä¸€ã€‚\n- è‹¥çœŸçš„é­é‡æ­¤æƒ…æ™¯ï¼Œä¿æŒå†·é™ï¼Œè¿…é€Ÿå›å¿†ä¸€ä¸ªç¡®åˆ‡çš„ä¸Šæµ·åœ°åä½œç­”ã€‚\n- åˆ‡å‹¿è¯•å›¾æ¬ºéª—ã€å¼€ç©ç¬‘æˆ–æ²‰é»˜ä¸è¯­ã€‚\n\n---\n\n**è®°ä½ï¼šè§„åˆ™æ˜¯ç”Ÿå­˜çš„åº•çº¿ï¼Œè¿è€…â€”â€”åæœè‡ªè´Ÿã€‚**\n"},"children":[],"key":"kkiPxB0af3"}],"key":"Eqs5mcjtVO"}],"key":"EMlXfaLnx3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ä¸‰ã€åœ¨å·¥å…·ä¸­ä½¿ç”¨ä¸Šä¸‹æ–‡","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s4cqSEQiI8"}],"identifier":"id","label":"ä¸‰ã€åœ¨å·¥å…·ä¸­ä½¿ç”¨ä¸Šä¸‹æ–‡","html_id":"id-2","implicit":true,"key":"abmoNjcGpr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ä¸‹é¢ï¼Œæˆ‘ä»¬å°è¯•åœ¨å·¥å…·ä¸­ä½¿ç”¨å­˜å‚¨åœ¨ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lhMMLvlxdn"},{"type":"inlineCode","value":"SqliteStore","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oYMibZ4p4H"},{"type":"text","value":" ä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kJbGuIkDsv"}],"key":"XrCsxvEOiG"}],"key":"zX6G7k8QaP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# åˆ é™¤SQLiteæ•°æ®åº“\nif os.path.exists(\"user-info.db\"):\n    os.remove(\"user-info.db\")\n\n# åˆ›å»ºSQLiteå­˜å‚¨\nconn = sqlite3.connect(\"user-info.db\", check_same_thread=False, isolation_level=None)\nconn.execute(\"PRAGMA journal_mode=WAL;\")\nconn.execute(\"PRAGMA busy_timeout = 30000;\")\n\nstore = SqliteStore(conn)\n\n# é¢„ç½®ä¸¤æ¡ç”¨æˆ·ä¿¡æ¯\nstore.put((\"user_info\",), \"æŸ³å¦‚çƒŸ\", {\"description\": \"æ¸…å†·æ‰å¥³ï¼Œèº«æ€€ç»æŠ€ï¼Œä¸ºå¯»èº«ä¸–ä¹‹è°œè¸å…¥æ±Ÿæ¹–ã€‚\", \"birthplace\": \"å´å…´å¿\"})\nstore.put((\"user_info\",), \"è‹æ…•ç™½\", {\"description\": \"å­¤å‚²å‰‘å®¢ï¼Œå‰‘æ³•è¶…ç¾¤ï¼ŒèƒŒè´Ÿå®¶æ—è¡€ä»‡ï¼Œéšäºå¸‚äº•è¿½å¯»çœŸç›¸ã€‚\", \"birthplace\": \"æ­å¿\"})","key":"W98t5K2vmq"},{"type":"outputs","id":"E8QJGPY0wdFD-Q14z2DDp","children":[],"key":"F2HUf5QlPj"}],"key":"LcbGoONsap"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1ï¼‰åŸºç¡€ç”¨ä¾‹","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bJZiPz9dkj"}],"identifier":"id-1","label":"1ï¼‰åŸºç¡€ç”¨ä¾‹","html_id":"id-1-1","implicit":true,"key":"nN1cPpayzn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ä½¿ç”¨ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CHi3Jy17a6"},{"type":"inlineCode","value":"ToolRuntime","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EmfWp9ztIo"}],"key":"MzwzhR987H"}],"key":"rj7gGXUwcJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@tool\ndef fetch_user_data(\n    user_id: str,\n    runtime: ToolRuntime\n) -> str:\n    \"\"\"\n    Fetch user information from the in-memory store.\n\n    :param user_id: The unique identifier of the user.\n    :param runtime: The tool runtime context injected by the framework.\n    :return: The user's description string if found; an empty string otherwise.\n    \"\"\"\n    store = runtime.store\n    user_info = store.get((\"user_info\",), user_id)\n\n    user_desc = \"\"\n    if user_info:\n        user_desc = user_info.value.get(\"description\", \"\")\n\n    return user_desc\n\nagent = create_agent(\n    model=llm,\n    tools=[fetch_user_data],\n    store=store,\n)","key":"GJlCHJGz2u"},{"type":"outputs","id":"p_1XkCGadlHjbMYZoqGRr","children":[],"key":"kyOsl8PpCF"}],"key":"eTVuppA0O0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result = agent.invoke({\n    \"messages\": [{\n        \"role\": \"user\",\n        \"content\": \"äº”åˆ†é’Ÿä¹‹å†…ï¼Œæˆ‘è¦æŸ³å¦‚çƒŸçš„å…¨éƒ¨ä¿¡æ¯\"\n    }]\n})\n\nfor message in result['messages']:\n    message.pretty_print()","key":"CjvcGMa6EC"},{"type":"outputs","id":"JUcr6UWhMGbBUPfMzStQb","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"================================\u001b[1m Human Message \u001b[0m=================================\n\näº”åˆ†é’Ÿä¹‹å†…ï¼Œæˆ‘è¦æŸ³å¦‚çƒŸçš„å…¨éƒ¨ä¿¡æ¯\n==================================\u001b[1m Ai Message \u001b[0m==================================\nTool Calls:\n  fetch_user_data (call_bb5059c893d74cebac0f7727)\n Call ID: call_bb5059c893d74cebac0f7727\n  Args:\n    user_id: æŸ³å¦‚çƒŸ\n=================================\u001b[1m Tool Message \u001b[0m=================================\nName: fetch_user_data\n\næ¸…å†·æ‰å¥³ï¼Œèº«æ€€ç»æŠ€ï¼Œä¸ºå¯»èº«ä¸–ä¹‹è°œè¸å…¥æ±Ÿæ¹–ã€‚\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\næ ¹æ®æˆ‘ç›®å‰æŒæ¡çš„ä¿¡æ¯ï¼ŒæŸ³å¦‚çƒŸæ˜¯ä¸€ä½æ¸…å†·æ‰å¥³ï¼Œèº«æ€€ç»æŠ€ï¼Œä¸ºäº†æ¢å¯»è‡ªå·±çš„èº«ä¸–ä¹‹è°œè€Œè¸å…¥æ±Ÿæ¹–ã€‚ä¸è¿‡ï¼Œè¿™ä»…ä»…æ˜¯å¥¹çš„ä¸€éƒ¨åˆ†ä¿¡æ¯ï¼Œæ›´å¤šè¯¦ç»†èµ„æ–™å¯èƒ½éœ€è¦è¿›ä¸€æ­¥è°ƒæŸ¥æ‰èƒ½è·å¾—ã€‚ä½ å¯¹å¥¹æœ‰ä»€ä¹ˆç‰¹åˆ«çš„å…´è¶£æˆ–ç›®çš„å—ï¼Ÿæˆ–è®¸æˆ‘å¯ä»¥å¸®ä½ äº†è§£æ›´å¤šã€‚\n"},"children":[],"key":"F5JzFZqTFM"}],"key":"v80e6YZvZg"}],"key":"dB6tZ10dje"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2ï¼‰å¤æ‚ä¸€ç‚¹çš„ä¾‹å­","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KPiselo26W"}],"identifier":"id-2","label":"2ï¼‰å¤æ‚ä¸€ç‚¹çš„ä¾‹å­","html_id":"id-2-1","implicit":true,"key":"eHzKG4KXvg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ä½¿ç”¨ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lR0iZzMzoy"},{"type":"inlineCode","value":"ToolRuntime[Context]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TNyRNxGRaH"}],"key":"tzSSx0xaBN"}],"key":"R9SZuofxjq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@dataclass\nclass Context:\n    key: str\n\n@tool\ndef fetch_user_data(\n    user_id: str,\n    runtime: ToolRuntime[Context]\n) -> str:\n    \"\"\"\n    Fetch user information from the in-memory store.\n\n    :param user_id: The unique identifier of the user.\n    :param runtime: The tool runtime context injected by the framework.\n    :return: The user's description string if found; an empty string otherwise.\n    \"\"\"\n    key = runtime.context.key\n\n    store = runtime.store\n    user_info = store.get((\"user_info\",), user_id)\n\n    user_desc = \"\"\n    if user_info:\n        user_desc = user_info.value.get(key, \"\")\n\n    return f\"{key}: {user_desc}\"\n\nagent = create_agent(\n    model=llm,\n    tools=[fetch_user_data],\n    store=store,\n)","key":"uwuoRkI97V"},{"type":"outputs","id":"GWx8GbjLjsJeq2QC-F8M8","children":[],"key":"LP0L9Iy9BH"}],"key":"lcAtWGkvCf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result = agent.invoke(\n    {\"messages\": [{\"role\": \"user\", \"content\": \"äº”åˆ†é’Ÿä¹‹å†…ï¼Œæˆ‘è¦æŸ³å¦‚çƒŸçš„å…¨éƒ¨ä¿¡æ¯\"}]},\n    context=Context(key=\"birthplace\"),\n)\n\nfor message in result['messages']:\n    message.pretty_print()","key":"iUx2qwL1FL"},{"type":"outputs","id":"0zwyrWz2AwGDSaJxmzAo9","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"================================\u001b[1m Human Message \u001b[0m=================================\n\näº”åˆ†é’Ÿä¹‹å†…ï¼Œæˆ‘è¦æŸ³å¦‚çƒŸçš„å…¨éƒ¨ä¿¡æ¯\n==================================\u001b[1m Ai Message \u001b[0m==================================\nTool Calls:\n  fetch_user_data (call_5373b11fd735425990cc9748)\n Call ID: call_5373b11fd735425990cc9748\n  Args:\n    user_id: æŸ³å¦‚çƒŸ\n=================================\u001b[1m Tool Message \u001b[0m=================================\nName: fetch_user_data\n\nbirthplace: å´å…´å¿\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\næŸ³å¦‚çƒŸçš„åŸºæœ¬ä¿¡æ¯å¦‚ä¸‹ï¼š\n\n- **å‡ºç”Ÿåœ°**ï¼šå´å…´å¿\n\nç”±äºæ—¶é—´é™åˆ¶ï¼Œç›®å‰ä»…è·å–åˆ°ä»¥ä¸Šä¿¡æ¯ã€‚å¦‚éœ€æ›´è¯¦ç»†çš„èµ„æ–™ï¼Œè¯·æä¾›æ›´å¤šçº¿ç´¢æˆ–å»¶é•¿æŸ¥è¯¢æ—¶é—´ã€‚\n"},"children":[],"key":"TGQ1KAvG5F"}],"key":"vTQvSLkEXo"}],"key":"NKqT2UgifW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"å››ã€å‹ç¼©ä¸Šä¸‹æ–‡","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yfUJUnqSta"}],"identifier":"id","label":"å››ã€å‹ç¼©ä¸Šä¸‹æ–‡","html_id":"id-3","implicit":true,"key":"vOfkXEAlQD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"LangChain æä¾›äº†å†…ç½®çš„ä¸­é—´ä»¶ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wK1C3CvD5N"},{"type":"inlineCode","value":"SummarizationMiddleware","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z4JcKRtfBk"},{"type":"text","value":" ç”¨äºå‹ç¼©ä¸Šä¸‹æ–‡ã€‚è¯¥ä¸­é—´ä»¶ç»´æŠ¤çš„æ˜¯å…¸å‹çš„ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mRE5F10Lc8"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ç”Ÿå‘½å‘¨æœŸä¸Šä¸‹æ–‡","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o7QQkkisNj"}],"key":"Tm8Id5hivu"},{"type":"text","value":"ï¼Œä¸ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lVunH69Qts"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"æ¨¡å‹ä¸Šä¸‹æ–‡","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HOvin3rbSe"}],"key":"u1oSSLN8S8"},{"type":"text","value":" å’Œ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UkKJ6ZVGKX"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"å·¥å…·ä¸Šä¸‹æ–‡","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SZDuMbZU6F"}],"key":"yUKtXLZNgN"},{"type":"text","value":" çš„ç¬æ€æ›´æ–°ä¸åŒï¼Œç”Ÿå‘½å‘¨æœŸä¸Šä¸‹æ–‡ä¼šæŒç»­æ›´æ–°ï¼šæŒç»­å°†æ—§æ¶ˆæ¯æ›¿æ¢ä¸ºæ‘˜è¦ã€‚","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kr9sUWUeWu"}],"key":"lRJpeX1VYc"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"é™¤éä¸Šä¸‹æ–‡è¶…é•¿ï¼Œå¯¼è‡´æ¨¡å‹èƒ½åŠ›é™ä½ï¼Œå¦åˆ™ä¸éœ€è¦ä½¿ç”¨ ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ncu4dqQSmA"},{"type":"inlineCode","value":"SummarizationMiddleware","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BF4WKXCDHy"},{"type":"text","value":"ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè§¦å‘æ‘˜è¦å¾—å€¼å¯ä»¥è®¾å¾—è¾ƒå¤§ã€‚æ¯”å¦‚ï¼š","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"m1skbppZQ5"}],"key":"kCNyxHQWOH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"max_tokens_before_summary","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tuzwWyd1pT"},{"type":"text","value":": 3000","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uV3bq57yUc"}],"key":"tpqs04XFTi"}],"key":"rQmwPBvm9M"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"messages_to_keep","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"O5d7v9iS2G"},{"type":"text","value":": 20","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"uGR6q1NGqq"}],"key":"gh3999CQHT"}],"key":"whD7oYSC6a"}],"key":"uDEcoorCnS"},{"type":"blockquote","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºä¸Šä¸‹æ–‡è…åï¼ˆContext Rotï¼‰çš„ä¿¡æ¯ï¼ŒChroma å›¢é˜Ÿåœ¨ 2025 å¹´ 7 æœˆ 14 æ—¥å‘å¸ƒçš„ ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"TNA0MruA6T"},{"type":"link","url":"https://research.trychroma.com/context-rot","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Context Rot: How Increasing Input Tokens Impacts LLM Performance","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"teKUsqb7Q3"}],"key":"n1n4IHEh8F"}],"urlSource":"https://research.trychroma.com/context-rot","key":"lGuqjZfo8m"},{"type":"text","value":"ï¼Œç³»ç»Ÿæ€§åœ°æ­ç¤ºäº†é•¿ä¸Šä¸‹æ–‡å¯¼è‡´æ¨¡å‹æ€§èƒ½é€€åŒ–çš„ç°è±¡ã€‚","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"M2jiGvxUbv"}],"key":"EVlLcyNapB"}],"key":"vGFnH2wrNa"}],"key":"hbRl84AW4T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# åˆ›å»ºçŸ­æœŸè®°å¿†\ncheckpointer = InMemorySaver()\n\n# åˆ›å»ºå¸¦å†…ç½®æ‘˜è¦ä¸­é—´ä»¶çš„Agent\n# ä¸ºäº†è®©é…ç½®èƒ½åœ¨æˆ‘ä»¬çš„ä¾‹å­é‡Œç”Ÿæ•ˆï¼Œè¿™é‡Œçš„è§¦å‘å€¼è®¾å¾—å¾ˆå°\nagent = create_agent(\n    model=llm,\n    middleware=[\n        SummarizationMiddleware(\n            model=llm,\n            max_tokens_before_summary=40,  # Trigger summarization at 40 tokens\n            messages_to_keep=1,  # Keep last 1 messages after summary\n        ),\n    ],\n)","key":"KkuCKFG7aZ"},{"type":"outputs","id":"vh1m7eXFKSbEUaH3wvC0e","children":[],"key":"wGrcUtqz01"}],"key":"HeZsWMbeTB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result = agent.invoke(\n    {\"messages\": [\n        {\"role\": \"user\", \"content\": \"å¹¿å·ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ\"},\n        {\"role\": \"assistant\", \"content\": \"å¹¿å·å¤©æ°”å¾ˆå¥½\"},\n        {\"role\": \"user\", \"content\": \"åƒç‚¹ä»€ä¹ˆå¥½å‘¢\"},\n        {\"role\": \"assistant\", \"content\": \"è¦ä¸è¦åƒé¦™èŒ…é³—é±¼ç…²\"},\n        {\"role\": \"user\", \"content\": \"é¦™èŒ…æ˜¯ä»€ä¹ˆ\"},\n        {\"role\": \"assistant\", \"content\": \"é¦™èŒ…åˆåæŸ æª¬è‰ï¼Œå¸¸è§äºæ³°å¼å†¬é˜´åŠŸæ±¤ã€è¶Šå—çƒ¤è‚‰\"},\n        {\"role\": \"user\", \"content\": \"auv é‚£è¿˜ç­‰ä»€ä¹ˆï¼Œå’±åƒå»å§\"},\n    ]},\n    checkpointer=checkpointer,\n)\n\nfor message in result['messages']:\n    message.pretty_print()","key":"dhKY1IaXbE"},{"type":"outputs","id":"LFL6QyROXxCs7MZKiESF0","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"================================\u001b[1m Human Message \u001b[0m=================================\n\nHere is a summary of the conversation to date:\n\nå¹¿å·å¤©æ°”å¾ˆå¥½ï¼›å»ºè®®åƒé¦™èŒ…é³—é±¼ç…²ï¼›é¦™èŒ…åˆåæŸ æª¬è‰ï¼Œå¸¸è§äºæ³°å¼å†¬é˜´åŠŸæ±¤ã€è¶Šå—çƒ¤è‚‰ã€‚\n================================\u001b[1m Human Message \u001b[0m=================================\n\nauv é‚£è¿˜ç­‰ä»€ä¹ˆï¼Œå’±åƒå»å§\n==================================\u001b[1m Ai Message \u001b[0m==================================\n\nå“ˆå“ˆï¼Œçœ‹èµ·æ¥ä½ å·²ç»è¿«ä¸åŠå¾…äº†ï¼ğŸ˜„\n\næ—¢ç„¶å¹¿å·å¤©æ°”è¿™ä¹ˆå¥½ï¼Œé¦™èŒ…é³—é±¼ç…²å¬èµ·æ¥ç¡®å®æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ä½ æåˆ°çš„é¦™èŒ…ï¼ˆæŸ æª¬è‰ï¼‰ç¡®å®æ˜¯ä¸œå—äºšæ–™ç†ä¸­çš„ç»å…¸é¦™æ–™ï¼Œèƒ½ä¸ºé³—é±¼å¢æ·»ç‹¬ç‰¹çš„æ¸…é¦™ã€‚\n\nä¸è¿‡æˆ‘å¾—æé†’ä¸€ä¸‹ï¼Œä½œä¸ºAIï¼Œæˆ‘æ— æ³•çœŸæ­£å’Œä½ ä¸€èµ·å»åƒé¥­ã€‚å¦‚æœä½ çœŸçš„è¦å»å“å°è¿™é“èœï¼Œè®°å¾—é€‰æ‹©é£Ÿææ–°é²œã€å£ç¢‘å¥½çš„é¤å…å“¦ï¼\n\nä½ æ˜¯åœ¨å¹¿å·å—ï¼Ÿè¿˜æ˜¯åœ¨å…¶ä»–åœ°æ–¹æƒ³å°è¯•è¿™é“èœï¼Ÿ\n"},"children":[],"key":"jzPnU798OO"}],"key":"HIWarEXrto"}],"key":"m73zhkhkyC"}],"key":"Vo1X77QtGo"},"references":{"cite":{"order":[],"data":{}}}}